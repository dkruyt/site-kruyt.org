<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Linux disk performance tuning | Dennis Kruyt</title>
<meta name="keywords" content="linux, tuning, performance, disk, harddisk" />
<meta name="description" content="Some option in Linux that can be used for disk related performance tuning.">
<meta name="author" content="Dennis Kruyt">
<link rel="canonical" href="https://kruyt.org/linux-disk-tuning/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://kruyt.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://kruyt.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kruyt.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://kruyt.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://kruyt.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.4" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Linux disk performance tuning" />
<meta property="og:description" content="Some option in Linux that can be used for disk related performance tuning." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kruyt.org/linux-disk-tuning/" />
<meta property="og:image" content="https://kruyt.org/images/2019/10/photo-1484662020986-75935d2ebc66--1-.jpeg" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-09-22T18:22:49&#43;00:00" />
<meta property="article:modified_time" content="2019-09-22T18:22:49&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://kruyt.org/images/2019/10/photo-1484662020986-75935d2ebc66--1-.jpeg" />
<meta name="twitter:title" content="Linux disk performance tuning"/>
<meta name="twitter:description" content="Some option in Linux that can be used for disk related performance tuning."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://kruyt.org/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Linux disk performance tuning",
      "item": "https://kruyt.org/linux-disk-tuning/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Linux disk performance tuning",
  "name": "Linux disk performance tuning",
  "description": "Some option in Linux that can be used for disk related performance tuning.",
  "keywords": [
    "linux", "tuning", "performance", "disk", "harddisk"
  ],
  "articleBody": "Disclaimer The options and values here are just to show what is possible these are not absolute magic values. And every workload is different. So measure, adjust, measure again, re adjust…\nRead-ahead Linux To get a better read-ahead on your disk you can set this to 4096 blocks instead of the default 256. This also depends on the type of use (read vs write) of the disk.\nFor example a database disk with a lots of reads you want a higher read-ahead. But this is very workload depended if you will have any result.\n/sbin/blockdev --setra 4096 /dev/sdb In order not to lose these settings after a reboot, place the following per disk in the _/etc/rc.local _ file.\n# Mysql Tuning for filesystem # Database Disk /sbin/blockdev --setra 4096 /dev/sdb # Logging Disk /sbin/blockdev --setra 256 /dev/sdc Mount options Especially in virtual machines that have their data on shared storage, it is important to prevent as many unnecessary I/O as possible. The option atime writes on every acces the acces time. Better to use is the option relatime. For application that don’t use the acces time on a dedicated mount point we can also use noatime.\n#     /dev/mapper/vg01-var /var ext4 defaults,relatime\t1 2 /dev/sdb /var/lib/mysql\text4 defaults,noatime\t1 2 Swappiness Linux The following setting in /etc/sysctl.d/swappiness.conf __ causes the kernel to write less aggressive RAM memory to swap space on disk. A couple of years ago a value of 0 was minimal swapping and valid. But with newer kernel releases this has changed. From RHEL 6.4 or Linux kernel 3.5-rc1 the behavior of the swappiness setting has changed. So check your distro/kernel what is valid and not.\n# Less aggressive swapping vm.swappiness = 1 Redhat recommends a value of 10 when running a dedicated Oracle database. MariaDB recommends a value of 1 when running a dedicated MariaDB database.\nDirty Pages This setting ensures that the kernel speeds up ‘dirty’ pages (changed datain RAM, which has not yet been written to disk) from memory to disk.In the past, with RAM sizing up to 1024MB, a high percentage was fine. Withthe huge amounts of RAM that some servers have this is that after a long time, large amounts of data are suddenly transferred to disk written when the limit is reached.This setting prevents peak load on storage and streamlines I/O.Change the following to /etc/sysctl.d/dirty_pages.conf:\n# Write dirty pages faster to disk vm.dirty_background_ratio = 3 vm.dirty_ratio = 40 I/O Scheduler Linux Some older Linux distributions are not yet adjusted to the virtual world. So the standard scheduler must be adjusted in the Virtual Machines. VMware has issued the following advice for this.\n The NOOP scheduler can also be used for fast storage backends (SAN / NAS). The Deadline scheduler can also be used as an alternative.\n To permanently and system-wide adjust the scheduler, the boot options of the kernel must be adjusted. Add the following to the GRUB_CMDLINE_LINUX_DEFAULT and regenerate grub.\nelevator=noop It is also possible to adjust the scheduler per disk unit. For example, by including this in /etc/rc.local.\n# Use NOOP Scheduler echo \"noop\"  /sys/block/sdb/queue/scheduler echo \"noop\"  /sys/block/sdc/queue/scheduler Use separate disk for database and transaction loggin Use a separate “virtual” disk for the database and a separate one for transaction logging if you are using a database on a server. This prevents the filling of the disk, for example, the log disk that the database disk also fills up and possible corruption. Another advantage with this is that you can use separate performance optimisation per disk. So you can set the database disk for example to perform better at reads and the transaction log disk better for writes. This is also valid for separating virtual disk over different datastores in a virtual environment.\nMonitor I/O on disks In dutch we say “meten is weten” **** which translates to “to measure is to know”. So you need to measure your disk performance to see if your changes have the result you want or not.\natop A nice CLI tool is atop in Linux_,_ here you can see semi realtime the write, reads, transfer speed, io times and wich proces claims the most disk time/\n  atop\n  telegraf, influxdb, grafana For monitoring whole environments, at home or at work. I use many times the TIG stack. Telegraf collects the metrics and stores them into InfluxDB. Grafana create then the graphs in nice dashboard. telegraf can also collects various disk performance metrics.\n  Grafana\n  observium Observium is a lamp stack tool that monitoring various metrics via SNMP. It also can monitor disk performance.\n  Observium\n  Disk To do a syntactic performance test, I used fio on Linux to test read, write and mixed performance.\n#Random Read Write ./fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=test --bs=4k --iodepth=64 --size=4G --readwrite=randrw --rwmixread=75 #Random Write ./fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=test --bs=4k --iodepth=64 --size=4G --readwrite=randread #Random Read ./fio --randrepeat=1 --ioengine=libaio --direct=1 --gtod_reduce=1 --name=test --filename=test --bs=4k --iodepth=64 --size=4G --readwrite=randwrite ",
  "wordCount" : "828",
  "inLanguage": "en",
  "image":"https://kruyt.org/images/2019/10/photo-1484662020986-75935d2ebc66--1-.jpeg","datePublished": "2019-09-22T18:22:49Z",
  "dateModified": "2019-09-22T18:22:49Z",
  "author":{
    "@type": "Person",
    "name": "Dennis Kruyt"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kruyt.org/linux-disk-tuning/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dennis Kruyt",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kruyt.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kruyt.org/" accesskey="h" title="Dennis Kruyt (Alt + H)">Dennis Kruyt</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Linux disk performance tuning
    </h1>
    <div class="post-meta"><span title='2019-09-22 18:22:49 +0000 UTC'>September 22, 2019</span>&nbsp;·&nbsp;Dennis Kruyt

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://kruyt.org/images/2019/10/photo-1484662020986-75935d2ebc66--1-.jpeg" alt="">
        
</figure>
  <div class="post-content"><h2 id="disclaimer">Disclaimer<a hidden class="anchor" aria-hidden="true" href="#disclaimer">#</a></h2>
<p>The options and values here are just to show what is possible these are not absolute magic values. And every workload is different. So measure, adjust, measure again, re adjust&hellip;</p>
<h2 id="read-ahead-linux">Read-ahead Linux<a hidden class="anchor" aria-hidden="true" href="#read-ahead-linux">#</a></h2>
<p>To get a better  read-ahead on your disk you can set this to 4096 blocks instead of the default 256. This also depends on the type of use (read vs write) of the disk.</p>
<p>For example a database disk with a lots of reads you want a higher read-ahead. But this is very workload depended if you will have any result.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/sbin/blockdev --setra <span style="color:#ae81ff">4096</span> /dev/sdb
</code></pre></div><p>In order not to lose these settings after a reboot, place the following per disk in the  _<strong>/etc/rc.local</strong> _ file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Mysql Tuning for filesystem</span>
<span style="color:#75715e"># Database Disk</span>
/sbin/blockdev --setra <span style="color:#ae81ff">4096</span> /dev/sdb
<span style="color:#75715e"># Logging Disk</span>
/sbin/blockdev --setra <span style="color:#ae81ff">256</span> /dev/sdc
</code></pre></div><h3 id="mount-options">Mount options<a hidden class="anchor" aria-hidden="true" href="#mount-options">#</a></h3>
<p>Especially in virtual machines that have their data on shared storage, it is important to prevent as many unnecessary I/O as possible. The option <strong>atime</strong> writes on every acces the acces time. Better to use is the option <strong>relatime</strong><em><strong>.</strong></em> For application that don&rsquo;t use the acces time on a dedicated mount point we can also use <strong>noatime</strong>.</p>
<pre tabindex="0"><code># &lt;file system&gt;         &lt;mount point&gt;  &lt;type&gt;  &lt;options&gt;              &lt;dump&gt;  &lt;pass&gt;
/dev/mapper/vg01-var    /var          	ext4    defaults,relatime	1       2
/dev/sdb    			/var/lib/mysql	ext4    defaults,noatime	1       2

</code></pre><h3 id="swappiness-linux">Swappiness Linux<a hidden class="anchor" aria-hidden="true" href="#swappiness-linux">#</a></h3>
<p>The following setting in <em><strong>/etc/sysctl.d/swappiness.conf</strong></em> <strong>__</strong> causes the kernel to write less aggressive RAM memory to swap space on disk. A couple of years ago a value of 0 was minimal swapping and valid. But with newer kernel releases this has changed. From RHEL 6.4 or Linux kernel 3.5-rc1 the behavior of the swappiness setting  has changed. So check your distro/kernel what is valid and not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Less aggressive swapping</span>
vm.swappiness <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><p>Redhat <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/s-memory-tunables">recommends</a> a value of 10 when running a dedicated Oracle database. MariaDB <a href="https://mariadb.com/kb/en/library/configuring-swappiness/">recommends</a> a value of 1 when running a dedicated MariaDB database.</p>
<h3 id="dirty-pages">Dirty Pages<a hidden class="anchor" aria-hidden="true" href="#dirty-pages">#</a></h3>
<p>This setting ensures that the kernel speeds up &lsquo;dirty&rsquo; pages (changed datain RAM, which has not yet been written to disk) from memory to disk.In the past, with RAM sizing up to 1024MB, a high percentage was fine. Withthe huge amounts of RAM that some servers have this is that after a long time, large amounts of data are suddenly transferred to disk written when the limit is reached.This setting prevents peak load on storage and streamlines I/O.Change the following to <em><strong>/etc/sysctl.d/dirty_pages.conf</strong></em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Write dirty pages faster to disk</span>
vm.dirty_background_ratio <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
vm.dirty_ratio <span style="color:#f92672">=</span> <span style="color:#ae81ff">40</span>
</code></pre></div><h3 id="io-scheduler-linux">I/O Scheduler Linux<a hidden class="anchor" aria-hidden="true" href="#io-scheduler-linux">#</a></h3>
<p>Some older Linux distributions are not yet adjusted to the virtual world. So the standard scheduler must be adjusted in the Virtual Machines. VMware has issued the following advice for this.</p>
<blockquote>
<p>The NOOP scheduler can also be used for fast storage backends (SAN / NAS). The Deadline scheduler can also be used as an alternative.</p>
</blockquote>
<p>To permanently and system-wide adjust the scheduler, the boot options of the kernel must be adjusted. Add the following to the GRUB_CMDLINE_LINUX_DEFAULT and regenerate grub.</p>
<pre tabindex="0"><code>elevator=noop
</code></pre><p>It is also possible to adjust the scheduler per disk unit. For example, by including this in <em><strong>/etc/rc.local</strong></em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Use NOOP Scheduler</span>
echo <span style="color:#e6db74">&#34;noop&#34;</span> &gt; /sys/block/sdb/queue/scheduler
echo <span style="color:#e6db74">&#34;noop&#34;</span> &gt; /sys/block/sdc/queue/scheduler
</code></pre></div><h3 id="use-separate-disk-for-database-and-transaction-loggin">Use separate disk for database and transaction loggin<a hidden class="anchor" aria-hidden="true" href="#use-separate-disk-for-database-and-transaction-loggin">#</a></h3>
<p>Use a separate &ldquo;virtual&rdquo; disk for the database and a separate one for transaction logging if you are using a database on a server. This prevents the filling of the disk, for example, the log disk that the database disk also fills up and possible corruption. Another advantage with this is that you can use separate performance optimisation per disk. So you can set the database disk for example to perform better at reads and the transaction log disk better for writes. This is also valid for separating virtual disk over different datastores in a virtual environment.</p>
<h2 id="monitor-io-on-disks">Monitor I/O on disks<a hidden class="anchor" aria-hidden="true" href="#monitor-io-on-disks">#</a></h2>
<p>In dutch we say &ldquo;meten is weten&rdquo; **** which translates to &ldquo;to measure is to know&rdquo;. So you need to measure your disk performance to see if your changes have the result you want or not.</p>
<h3 id="atop">atop<a hidden class="anchor" aria-hidden="true" href="#atop">#</a></h3>
<p>A nice CLI tool is <em>atop</em> in Linux_,_ here you can see semi realtime the write, reads, transfer speed, io times and wich proces claims the most disk time/</p>
<figure>
    <img loading="lazy" src="/images/2019/09/image-16.png"
         alt="atop"/> <figcaption>
            <p>atop</p>
        </figcaption>
</figure>

<h3 id="telegraf-influxdb-grafana">telegraf, influxdb, grafana<a hidden class="anchor" aria-hidden="true" href="#telegraf-influxdb-grafana">#</a></h3>
<p>For monitoring whole environments, at home or at work. I use many times the TIG stack. Telegraf collects the metrics and stores them into InfluxDB. Grafana create then the graphs in nice dashboard. telegraf can also collects various disk performance metrics.</p>
<figure>
    <img loading="lazy" src="/images/2019/09/image-15.png"
         alt="Grafana"/> <figcaption>
            <p>Grafana</p>
        </figcaption>
</figure>

<h3 id="observium">observium<a hidden class="anchor" aria-hidden="true" href="#observium">#</a></h3>
<p>Observium is a lamp stack tool that monitoring various metrics via SNMP. It also can monitor disk performance.</p>
<figure>
    <img loading="lazy" src="/images/2019/09/image-17.png"
         alt="Observium"/> <figcaption>
            <p>Observium</p>
        </figcaption>
</figure>

<h3 id="disk"><strong>Disk</strong><a hidden class="anchor" aria-hidden="true" href="#disk">#</a></h3>
<p>To do a syntactic performance test, I used <a href="https://github.com/axboe/fio">fio</a> on Linux to test read, write and mixed performance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#Random Read Write</span>
./fio --randrepeat<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --ioengine<span style="color:#f92672">=</span>libaio --direct<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --gtod_reduce<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --name<span style="color:#f92672">=</span>test --filename<span style="color:#f92672">=</span>test --bs<span style="color:#f92672">=</span>4k --iodepth<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span> --size<span style="color:#f92672">=</span>4G --readwrite<span style="color:#f92672">=</span>randrw --rwmixread<span style="color:#f92672">=</span><span style="color:#ae81ff">75</span>

<span style="color:#75715e">#Random Write</span>
./fio --randrepeat<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --ioengine<span style="color:#f92672">=</span>libaio --direct<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --gtod_reduce<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --name<span style="color:#f92672">=</span>test --filename<span style="color:#f92672">=</span>test --bs<span style="color:#f92672">=</span>4k --iodepth<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span> --size<span style="color:#f92672">=</span>4G --readwrite<span style="color:#f92672">=</span>randread

<span style="color:#75715e">#Random Read</span>
./fio --randrepeat<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --ioengine<span style="color:#f92672">=</span>libaio --direct<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --gtod_reduce<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --name<span style="color:#f92672">=</span>test --filename<span style="color:#f92672">=</span>test --bs<span style="color:#f92672">=</span>4k --iodepth<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span> --size<span style="color:#f92672">=</span>4G --readwrite<span style="color:#f92672">=</span>randwrite

</code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kruyt.org/tags/linux/">linux</a></li>
      <li><a href="https://kruyt.org/tags/tuning/">tuning</a></li>
      <li><a href="https://kruyt.org/tags/performance/">performance</a></li>
      <li><a href="https://kruyt.org/tags/disk/">disk</a></li>
      <li><a href="https://kruyt.org/tags/harddisk/">harddisk</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="https://kruyt.org/">Dennis Kruyt</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
