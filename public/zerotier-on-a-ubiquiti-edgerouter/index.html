<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ZeroTier on a Ubiquiti EdgeRouter | Dennis Kruyt</title>
<meta name="keywords" content="edgerouter, zerotier, sdwan, networking, edgeos, Ubiquiti, network, vyos" />
<meta name="description" content="With the new EdgeOS version 2 firmware for the EdgeRouter it is now possible to install ZeroTier on this router.">
<meta name="author" content="Dennis Kruyt">
<link rel="canonical" href="https://kruyt.org/zerotier-on-a-ubiquiti-edgerouter/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://kruyt.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://kruyt.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kruyt.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://kruyt.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://kruyt.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.4" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="ZeroTier on a Ubiquiti EdgeRouter" />
<meta property="og:description" content="With the new EdgeOS version 2 firmware for the EdgeRouter it is now possible to install ZeroTier on this router." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kruyt.org/zerotier-on-a-ubiquiti-edgerouter/" />
<meta property="og:image" content="https://kruyt.org/images/2019/10/photo-1477519242566-6ae87c31d212--1-.jpeg" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-08-31T17:36:31&#43;00:00" />
<meta property="article:modified_time" content="2019-08-31T17:36:31&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://kruyt.org/images/2019/10/photo-1477519242566-6ae87c31d212--1-.jpeg" />
<meta name="twitter:title" content="ZeroTier on a Ubiquiti EdgeRouter"/>
<meta name="twitter:description" content="With the new EdgeOS version 2 firmware for the EdgeRouter it is now possible to install ZeroTier on this router."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://kruyt.org/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ZeroTier on a Ubiquiti EdgeRouter",
      "item": "https://kruyt.org/zerotier-on-a-ubiquiti-edgerouter/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ZeroTier on a Ubiquiti EdgeRouter",
  "name": "ZeroTier on a Ubiquiti EdgeRouter",
  "description": "With the new EdgeOS version 2 firmware for the EdgeRouter it is now possible to install ZeroTier on this router.",
  "keywords": [
    "edgerouter", "zerotier", "sdwan", "networking", "edgeos", "Ubiquiti", "network", "vyos"
  ],
  "articleBody": "With the new EdgeOS version 2 firmware for the Ubiquiti EdgeRouter it is now possible to install ZeroTier on this router. This post wil give you instructions on how to do this.\nI use ZeroTier on this router to create connections the my containers on my containers hosts in the cloud. With ZeroTier installed on my EdgeRouter Lite I can connect to them directly from all my machines at home. My connections are managed routes with ZeroTier. Bridging should work also, but I didn’t try it, it will take a little more work.\n  edgeRouter Lite\n  What is ZeroTier  ZeroTier is a smart Ethernet switch for planet Earth.\n  It’s a distributed network hypervisor built atop a cryptographically secure global peer to peer network. It provides advanced network virtualization and management capabilities on par with an enterprise SDN switch, but across both local and wide area networks and connecting almost any kind of app or device.\n   ZeroTier logo\n  Instructions Install ZeroTier on EdgeRouter First login on your EdgeRouter en sudo to root, then use curl to get the install script from ZeroTier itself.\nadmin@edgerouter# sudo -i root@edgerouter:~# curl -s https://install.zerotier.com | sudo bash *** ZeroTier One Quick Install for Unix-like Systems *** Tested distributions and architectures: *** MacOS (10.7+) on x86_64 (just installs ZeroTier One.pkg) *** Debian (7+) on x86_64, x86, arm, and arm64 *** RedHat/CentOS (6+) on x86_64 and x86 *** Fedora (16+) on x86_64 and x86 *** SuSE (12+) on x86_64 and x86 *** Mint (18+) on x86_64, x86, arm, and arm64 *** Please report problems to contact@zerotier.com and we will try to fix. *** Detecting Linux Distribution *** Found Debian \"stretch\" (or similar), creating /etc/apt/sources.list.d/zerotier.list OK *** Installing zerotier-one package...  *** Enabling and starting zerotier-one service... Synchronizing state of zerotier-one.service with SysV service script with /lib/systemd/systemd-sysv-install. Executing: /lib/systemd/systemd-sysv-install enable zerotier-one *** Waiting for identity generation... *** Success! You are ZeroTier address [ 5fca9e9471 ]. If the install successful you will get a ZeroTier address. If not, take a look at your firewall logs/settings. If successful you can join your ZeroTier network.\nPersistent after firmware upgrade To make ZeroTier config persistent after firmware updates, we need to move the /var/lib/zerotier to /config/script.\nroot@edgerouter:/etc# cd /var/lib root@edgerouter:/var/lib# mv /var/lib/zerotier-one /config/scripts/ root@edgerouter:/var/lib# ln -s /config/scripts/zerotier-one Possible after a firmware upgrade you may need to recreate the symlink again. But your ZeroTier networks will be preserved.\nMap your ZeroTier interface The part below is not necessary any more if you install my package to use the EdgeOS CLI.\nZeroTier on a Ubiquiti EdgeRouter (part 2) In my previous post I showed how to install ZeroTier on the EdgeRouter, after\\ninstalling we need to rename the ZeroTier interface to ethx interface to show up\\nin EdgeOS. ZeroTier on a Ubiquiti EdgeRouterWith the new EdgeOS version 2 firmware for the\\nEdgeRouter it is now possible to install ZeroTier… Dennis Kruyt Kruyt.org      The EdgeOS won’t show and interact with your ZeroTier interface properly. This because it doesn’t know how the handle a ztxxxxx interface. To work around we need to change the ztxxxxx interface name to a ethx name. To do this create a new file /var/lib/zerotier-one/devicemap with the following content.\nReplace  with your ZeroTier network. If you have more network’s then create a entry for each network with a unique ethx interface.\n=eth4  If you have an other Edgerouter model with more then 3 ethx ports, then increase the number 4 to a free one.\n Then restart ZeroTier to create the new mapped interface.\nroot@edgerouter:~# /etc/init.d/zerotier-one restart [ ok ] Restarting zerotier-one (via systemctl): zerotier-one.service. root@edgerouter:~# ifconfig eth4 eth4: flags=4163 mtu 2800 inet 10.122.12.95 netmask 255.255.255.0 broadcast 10.147.17.255 inet6 fe80::6cb5:75ff:fe9a:e2 prefixlen 64 scopeid 0x20 ether 6e:b5:75:9a:00:e2 txqueuelen 1000 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 7 bytes 738 (738.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 Enable new ethx interface in EdgeOS Then to enable the interface in EdgeOS, do the following per interface. And change the description to your network id.\nadmin@edgerouter# set interfaces ethernet eth4 description \"ZeroTier 1d73947417ceeb6e\" [edit] admin@edgerouter# commit [edit] admin@edgerouter# save Saving configuration to '/config/config.boot'... Done After this, login the web interface. Now you will see a eth4, your ZeroTier interface. It will also show up now in your firewall rules. So now you can your ZeroTier interface as any other interface physical on your router.\n  Also the UNMS interface shows the ZeroTier interface, but it shows the MTU with a red underline, But this is the correct value for a ZeroTier interface, so don’t change it.\n  Performance I did some testing with iperf trough my EdgeRouter Lite. I was able to get between 20 and 30 Mbits/sec. The bottleneck is that the ZeroTier process on the EdgeRouter Lite is maxed out due to the small CPU on the EdgeRouter Lite. Other bigger EdgeRouter models may perform better.\nAfter I installed ZeroTier on the router I noticed a increase in CPU usage, even there is barely any traffic on the ZeroTier interface.\n  CPU\n    ZeroTier interface traffic\n  ",
  "wordCount" : "841",
  "inLanguage": "en",
  "image":"https://kruyt.org/images/2019/10/photo-1477519242566-6ae87c31d212--1-.jpeg","datePublished": "2019-08-31T17:36:31Z",
  "dateModified": "2019-08-31T17:36:31Z",
  "author":{
    "@type": "Person",
    "name": "Dennis Kruyt"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kruyt.org/zerotier-on-a-ubiquiti-edgerouter/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dennis Kruyt",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kruyt.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kruyt.org/" accesskey="h" title="Dennis Kruyt (Alt + H)">Dennis Kruyt</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      ZeroTier on a Ubiquiti EdgeRouter
    </h1>
    <div class="post-meta"><span title='2019-08-31 17:36:31 +0000 UTC'>August 31, 2019</span>&nbsp;·&nbsp;Dennis Kruyt

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://kruyt.org/images/2019/10/photo-1477519242566-6ae87c31d212--1-.jpeg" alt="">
        
</figure>
  <div class="post-content"><p>With the new EdgeOS version 2 firmware for the Ubiquiti <a href="https://www.ui.com/edgemax/edgerouter/">EdgeRouter</a> it is now possible to install <a href="https://www.zerotier.com/">ZeroTier</a> on this router. This post wil give you instructions on how to do this.</p>
<p>I use ZeroTier on this router to create connections the my containers on my containers hosts in the cloud. With ZeroTier installed on my EdgeRouter Lite I can connect to them directly from all my machines at home. My connections are managed routes with ZeroTier. Bridging should work also, but I didn&rsquo;t try it, it will take a little more work.</p>
<figure>
    <img loading="lazy" src="/images/2019/08/ubiquiti-edgemax-edgerouter-lite-erlite-3-server-1707-13-server@13-1.jpg"
         alt="edgeRouter Lite"/> <figcaption>
            <p>edgeRouter Lite</p>
        </figcaption>
</figure>

<h3 id="what-is-zerotier">What is ZeroTier<a hidden class="anchor" aria-hidden="true" href="#what-is-zerotier">#</a></h3>
<blockquote>
<p>ZeroTier is a smart Ethernet switch for planet Earth.</p>
</blockquote>
<blockquote>
<p>It’s a distributed network hypervisor built atop a cryptographically secure global peer to peer network. It provides advanced network virtualization and management capabilities on par with an enterprise SDN switch, but across both local and wide area networks and connecting almost any kind of app or device.</p>
</blockquote>
<figure>
    <img loading="lazy" src="/images/2019/08/150px-ZeroTier_Logo.png"
         alt="ZeroTier logo"/> <figcaption>
            <p>ZeroTier logo</p>
        </figcaption>
</figure>

<h2 id="instructions">Instructions<a hidden class="anchor" aria-hidden="true" href="#instructions">#</a></h2>
<h3 id="install-zerotier-on-edgerouter">Install ZeroTier on EdgeRouter<a hidden class="anchor" aria-hidden="true" href="#install-zerotier-on-edgerouter">#</a></h3>
<p>First login on your EdgeRouter en sudo to root, then use curl to get the install script from ZeroTier itself.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">admin@edgerouter# sudo -i
root@edgerouter:~# curl -s https://install.zerotier.com | sudo bash

*** ZeroTier One Quick Install <span style="color:#66d9ef">for</span> Unix-like Systems

*** Tested distributions and architectures:
***   MacOS <span style="color:#f92672">(</span>10.7+<span style="color:#f92672">)</span> on x86_64 <span style="color:#f92672">(</span>just installs ZeroTier One.pkg<span style="color:#f92672">)</span>
***   Debian <span style="color:#f92672">(</span>7+<span style="color:#f92672">)</span> on x86_64, x86, arm, and arm64
***   RedHat/CentOS <span style="color:#f92672">(</span>6+<span style="color:#f92672">)</span> on x86_64 and x86
***   Fedora <span style="color:#f92672">(</span>16+<span style="color:#f92672">)</span> on x86_64 and x86
***   SuSE <span style="color:#f92672">(</span>12+<span style="color:#f92672">)</span> on x86_64 and x86
***   Mint <span style="color:#f92672">(</span>18+<span style="color:#f92672">)</span> on x86_64, x86, arm, and arm64

*** Please report problems to contact@zerotier.com and we will try to fix.

*** Detecting Linux Distribution

*** Found Debian <span style="color:#e6db74">&#34;stretch&#34;</span> <span style="color:#f92672">(</span>or similar<span style="color:#f92672">)</span>, creating /etc/apt/sources.list.d/zerotier.list
OK

*** Installing zerotier-one package...
&lt;cut&gt;
*** Enabling and starting zerotier-one service...
Synchronizing state of zerotier-one.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable zerotier-one

*** Waiting <span style="color:#66d9ef">for</span> identity generation...

*** Success! You are ZeroTier address <span style="color:#f92672">[</span> 5fca9e9471 <span style="color:#f92672">]</span>.
</code></pre></div><p>If the install successful you will get a ZeroTier address. If not, take a look at your firewall logs/settings. If successful you can join your ZeroTier network.</p>
<h3 id="persistent-after-firmware-upgrade">Persistent after firmware upgrade<a hidden class="anchor" aria-hidden="true" href="#persistent-after-firmware-upgrade">#</a></h3>
<p>To make ZeroTier config persistent after firmware updates, we need to move the <em>/var/lib/zerotier</em> to <em>/config/script.</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@edgerouter:/etc# cd /var/lib
root@edgerouter:/var/lib# mv /var/lib/zerotier-one /config/scripts/
root@edgerouter:/var/lib# ln -s /config/scripts/zerotier-one
</code></pre></div><p>Possible after a firmware upgrade you may need to recreate the symlink again. But your ZeroTier networks will be preserved.</p>
<h3 id="map-your-zerotier-interface">Map your ZeroTier interface<a hidden class="anchor" aria-hidden="true" href="#map-your-zerotier-interface">#</a></h3>
<p>The part below is not necessary any more if you install my package to use the EdgeOS CLI.</p>
<figure class="kg-card kg-bookmark-card">
  <a href="https://blog.kruyt.org/zerotier-on-edgerouter-p2/" class="kg-bookmark-container">
    <div class="kg-bookmark-content">
      <div class="kg-bookmark-title">ZeroTier on a Ubiquiti EdgeRouter (part 2)</div>
      <div class="kg-bookmark-description">In my previous post I showed how to install ZeroTier on the EdgeRouter, after\ninstalling we need to rename the ZeroTier interface to ethx interface to show up\nin EdgeOS. ZeroTier on a Ubiquiti EdgeRouterWith the new EdgeOS version 2 firmware for the\nEdgeRouter it is now possible to install ZeroTier…</div>
      <div class="kg-bookmark-metadata">
        <img src="https://blog.kruyt.org/favicon.ico" class="kg-bookmark-icon">
        <span class="kg-bookmark-author">Dennis Kruyt</span>
        <span class="kg-bookmark-publisher">Kruyt.org</span>
      </div>
    </div>
    
    <div class="kg-bookmark-thumbnail">
      <img src="/images/2019/09/photo-1465447142348-e9952c393450.jpeg">
    </div>
    
  </a>
  
</figure>
<p>The EdgeOS won&rsquo;t show and interact with your ZeroTier interface properly. This because it doesn&rsquo;t know how the handle a ztxxxxx interface. To work around we need to change the ztxxxxx interface name to a ethx name. To do this create a new file <em>/var/lib/zerotier-one/devicemap</em> with the following content.</p>
<p>Replace <em><zerotiernetworkid></em> with your ZeroTier network. If you have more network&rsquo;s then create a entry for each network with a unique ethx interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&lt;zerotiernetworkid&gt;<span style="color:#f92672">=</span>eth4
</code></pre></div><blockquote>
<p>If you have an other Edgerouter model with more then 3 ethx ports, then increase the number 4 to a free one.</p>
</blockquote>
<p>Then restart ZeroTier to create the new mapped interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@edgerouter:~# /etc/init.d/zerotier-one restart
<span style="color:#f92672">[</span> ok <span style="color:#f92672">]</span> Restarting zerotier-one <span style="color:#f92672">(</span>via systemctl<span style="color:#f92672">)</span>: zerotier-one.service.
root@edgerouter:~# ifconfig eth4
eth4: flags<span style="color:#f92672">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style="color:#ae81ff">2800</span>
        inet 10.122.12.95  netmask 255.255.255.0  broadcast 10.147.17.255
        inet6 fe80::6cb5:75ff:fe9a:e2  prefixlen <span style="color:#ae81ff">64</span>  scopeid 0x20&lt;link&gt;
        ether 6e:b5:75:9a:00:e2  txqueuelen <span style="color:#ae81ff">1000</span>  <span style="color:#f92672">(</span>Ethernet<span style="color:#f92672">)</span>
        RX packets <span style="color:#ae81ff">0</span>  bytes <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0.0 B<span style="color:#f92672">)</span>
        RX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span>  overruns <span style="color:#ae81ff">0</span>  frame <span style="color:#ae81ff">0</span>
        TX packets <span style="color:#ae81ff">7</span>  bytes <span style="color:#ae81ff">738</span> <span style="color:#f92672">(</span>738.0 B<span style="color:#f92672">)</span>
        TX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span> overruns <span style="color:#ae81ff">0</span>  carrier <span style="color:#ae81ff">0</span>  collisions <span style="color:#ae81ff">0</span>
</code></pre></div><h3 id="enable-new-ethx-interface-in-edgeos">Enable new ethx interface in EdgeOS<a hidden class="anchor" aria-hidden="true" href="#enable-new-ethx-interface-in-edgeos">#</a></h3>
<p>Then to enable the interface in EdgeOS, do the following per interface. And change the description to your network id.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">admin@edgerouter# set interfaces ethernet eth4 description <span style="color:#e6db74">&#34;ZeroTier 1d73947417ceeb6e&#34;</span>
<span style="color:#f92672">[</span>edit<span style="color:#f92672">]</span>
admin@edgerouter# commit
<span style="color:#f92672">[</span>edit<span style="color:#f92672">]</span>
admin@edgerouter# save
Saving configuration to <span style="color:#e6db74">&#39;/config/config.boot&#39;</span>...
Done
</code></pre></div><p>After this, login the web interface. Now you will see a eth4, your ZeroTier interface. It will also show up now in your firewall rules. So now you can your ZeroTier interface as any other interface physical on your router.</p>
<figure>
    <img loading="lazy" src="/images/2019/08/EdgeOS_-_edgerouter.png"/> 
</figure>

<p>Also the UNMS interface shows the ZeroTier interface, but it shows the MTU with a red underline, But this is the correct value for a ZeroTier interface, so don&rsquo;t change it.</p>
<figure>
    <img loading="lazy" src="/images/2019/09/UNMS_1_0_1-2.jpg"/> 
</figure>

<h3 id="performance">Performance<a hidden class="anchor" aria-hidden="true" href="#performance">#</a></h3>
<p>I did some testing with <em>iperf</em> trough my EdgeRouter Lite. I was able to get between 20 and 30 Mbits/sec. The bottleneck is that the ZeroTier process on the EdgeRouter Lite is maxed out due to the <em>small</em>  <em>CPU</em> on the EdgeRouter Lite. Other bigger EdgeRouter models may perform better.</p>
<p>After I installed ZeroTier on the router I noticed a increase in CPU usage, even there is barely any traffic on the ZeroTier interface.</p>
<figure>
    <img loading="lazy" src="/images/2019/09/Mblq4iTx3TuphYfj.png"
         alt="CPU"/> <figcaption>
            <p>CPU</p>
        </figcaption>
</figure>

<figure>
    <img loading="lazy" src="/images/2019/09/B93FoM8epRqGS4hw.png"
         alt="ZeroTier interface traffic"/> <figcaption>
            <p>ZeroTier interface traffic</p>
        </figcaption>
</figure>



  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kruyt.org/tags/edgerouter/">edgerouter</a></li>
      <li><a href="https://kruyt.org/tags/zerotier/">zerotier</a></li>
      <li><a href="https://kruyt.org/tags/sdwan/">sdwan</a></li>
      <li><a href="https://kruyt.org/tags/networking/">networking</a></li>
      <li><a href="https://kruyt.org/tags/edgeos/">edgeos</a></li>
      <li><a href="https://kruyt.org/tags/Ubiquiti/">Ubiquiti</a></li>
      <li><a href="https://kruyt.org/tags/network/">network</a></li>
      <li><a href="https://kruyt.org/tags/vyos/">vyos</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="https://kruyt.org/">Dennis Kruyt</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
