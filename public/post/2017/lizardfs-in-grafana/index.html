<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>LizardFS in Grafana | Dennis Kruyt</title>
<meta name="keywords" content="grafana, telegraf, influxdb, lizardfs" />
<meta name="description" content="This plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard.">
<meta name="author" content="Dennis Kruyt">
<link rel="canonical" href="https://kruyt.org/post/2017/lizardfs-in-grafana/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://kruyt.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://kruyt.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kruyt.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://kruyt.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://kruyt.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.4" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="LizardFS in Grafana" />
<meta property="og:description" content="This plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kruyt.org/post/2017/lizardfs-in-grafana/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-08-14T19:59:32&#43;00:00" />
<meta property="article:modified_time" content="2017-08-14T19:59:32&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="LizardFS in Grafana"/>
<meta name="twitter:description" content="This plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://kruyt.org/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "LizardFS in Grafana",
      "item": "https://kruyt.org/post/2017/lizardfs-in-grafana/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LizardFS in Grafana",
  "name": "LizardFS in Grafana",
  "description": "This plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard.",
  "keywords": [
    "grafana", "telegraf", "influxdb", "lizardfs"
  ],
  "articleBody": "LizardFS is a Software Defined Storage, distributed, parallel, scalable, fault-tolerant, Geo-Redundant and highly available file system. I created a s plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard.\nPre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first.\nInstall Get all the files, at My GitHub page.\n Put lizardfs.conf and lizardfs.sh in your /etc/telegraf/telegraf.d directory. Edit the file lizardfs.sh and change LFSADMIN variable as appropriate for your lizardfs-admin binary. Edit the file lizardfs.sh and change the LIZARDHOSTS to your lizardmaster, you can add multple lizardsclusters here as needed.  Test test with:\ntelegraf --test --config /etc/telegraf/telegraf.d/lizardfs.conf It should produce some thing like this:\n* Plugin: inputs.exec, Collection 1  lizard_info,lizardmaster=192.168.0.1,host=lxh-sysa-005 FS_objects=470118,Directories=36961,Files=432583,Memory_usage=198946816,Total_space=37159571947520,Available_space=22595288821760,Trash_files=0,Chunk_copies=643179,Regular_copies_deprecated=643179,Trash_space=0,Reserved_space=0,Reserved_files=0,Chunks=214393 1502747150000000000  lizard_ready-chunkservers-count,lizardmaster=192.168.0.1,host=lxh-sysa-005 chunkservers-count=10 1502747150000000000  lizard_chunks-health,state=AVA,goal=1,host=lxh-sysa-005,lizardmaster=192.168.0.1 safe=0,unsafe=0,lost=0 1502747150000000000  lizard_chunks-health,goal=2,host=lxh-sysa-005,lizardmaster=192.168.0.1,state=AVA unsafe=0,lost=0,safe=0 1502747150000000000  lizard_chunks-health,lizardmaster=192.168.0.1,state=AVA,goal=3,host=lxh-sysa-005 unsafe=0,lost=0,safe=214393 1502747150000000000 ***snip***  lizard_disks,lizardmaster=192.168.0.1,chunkserver=192.168.174.63:9533,path=/data/1/data/3.10.4/,host=lxh-sysa-005 max_fsync_time=0,used_space=705392361472,chunks=32392,read_bytes=0,max_write_time=0,read_ops=0,fsync_ops=0,to_delete=\"no\",damaged=\"no\",scanning=\"no\",written_bytes=0,max_read_time=0,last_error=\"0\",total_space=1857978597376,write_ops=0 1502747150000000000 Restart telegraf execute:\nservice telegraf restart After this it should log the statistics of LizardFS in InfluxDB. Now you can import the dashboard Grafana LizardFS Metrics.json for LizardFS in Grafana.\nScreenshot After you setup all, you should have some dashboard like this.\n",
  "wordCount" : "199",
  "inLanguage": "en",
  "datePublished": "2017-08-14T19:59:32Z",
  "dateModified": "2017-08-14T19:59:32Z",
  "author":{
    "@type": "Person",
    "name": "Dennis Kruyt"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kruyt.org/post/2017/lizardfs-in-grafana/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dennis Kruyt",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kruyt.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kruyt.org/" accesskey="h" title="Dennis Kruyt (Alt + H)">Dennis Kruyt</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      LizardFS in Grafana
    </h1>
    <div class="post-meta"><span title='2017-08-14 19:59:32 +0000 UTC'>August 14, 2017</span>&nbsp;Â·&nbsp;Dennis Kruyt

</div>
  </header> 
  <div class="post-content"><p>LizardFS is a Software Defined Storage, distributed, parallel, scalable,
fault-tolerant, Geo-Redundant and highly available file system. I created a s plugin/script for Telegraf will collect the metrics from LizardFS and stores it into InfluxDB, then you can view your metrics in Grafana on a templated dashboard.</p>
<p><img loading="lazy" src="https://lizardfs.com/wp-content/uploads/2016/12/lizardfs-servers3-e1516293779641.jpg" alt=""  />
</p>
<h3 id="pre-install">Pre install<a hidden class="anchor" aria-hidden="true" href="#pre-install">#</a></h3>
<p>Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first.</p>
<h3 id="install">Install<a hidden class="anchor" aria-hidden="true" href="#install">#</a></h3>
<p>Get all the files, at <a href="https://github.com/dkruyt/LizardFS_Grafana">My GitHub page</a>.</p>
<ul>
<li>Put <em>lizardfs.conf</em> and <em>lizardfs.sh</em> in your <code>/etc/telegraf/telegraf.d</code> directory.</li>
<li>Edit the file <em>lizardfs.sh</em> and change LFSADMIN variable as appropriate for your <em>lizardfs-admin</em> binary.</li>
<li>Edit the file <em>lizardfs.sh</em> and change the LIZARDHOSTS to your lizardmaster, you can add multple lizardsclusters here as needed.</li>
</ul>
<h3 id="test">Test<a hidden class="anchor" aria-hidden="true" href="#test">#</a></h3>
<p>test with:</p>
<pre tabindex="0"><code>telegraf --test --config /etc/telegraf/telegraf.d/lizardfs.conf
</code></pre><p>It should produce some thing like this:</p>
<pre tabindex="0"><code>* Plugin: inputs.exec, Collection 1
&gt; lizard_info,lizardmaster=192.168.0.1,host=lxh-sysa-005 FS_objects=470118,Directories=36961,Files=432583,Memory_usage=198946816,Total_space=37159571947520,Available_space=22595288821760,Trash_files=0,Chunk_copies=643179,Regular_copies_deprecated=643179,Trash_space=0,Reserved_space=0,Reserved_files=0,Chunks=214393 1502747150000000000
&gt; lizard_ready-chunkservers-count,lizardmaster=192.168.0.1,host=lxh-sysa-005 chunkservers-count=10 1502747150000000000
&gt; lizard_chunks-health,state=AVA,goal=1,host=lxh-sysa-005,lizardmaster=192.168.0.1 safe=0,unsafe=0,lost=0 1502747150000000000
&gt; lizard_chunks-health,goal=2,host=lxh-sysa-005,lizardmaster=192.168.0.1,state=AVA unsafe=0,lost=0,safe=0 1502747150000000000
&gt; lizard_chunks-health,lizardmaster=192.168.0.1,state=AVA,goal=3,host=lxh-sysa-005 unsafe=0,lost=0,safe=214393 1502747150000000000

***snip***

&gt; lizard_disks,lizardmaster=192.168.0.1,chunkserver=192.168.174.63:9533,path=/data/1/data/3.10.4/,host=lxh-sysa-005 max_fsync_time=0,used_space=705392361472,chunks=32392,read_bytes=0,max_write_time=0,read_ops=0,fsync_ops=0,to_delete=&quot;no&quot;,damaged=&quot;no&quot;,scanning=&quot;no&quot;,written_bytes=0,max_read_time=0,last_error=&quot;0&quot;,total_space=1857978597376,write_ops=0 1502747150000000000
</code></pre><h3 id="restart-telegraf">Restart telegraf<a hidden class="anchor" aria-hidden="true" href="#restart-telegraf">#</a></h3>
<p>execute:</p>
<pre tabindex="0"><code>service telegraf restart
</code></pre><p>After this it should log the statistics of LizardFS in InfluxDB. Now you can import the dashboard <em>Grafana LizardFS Metrics.json</em> for LizardFS in Grafana.</p>
<h3 id="screenshot">Screenshot<a hidden class="anchor" aria-hidden="true" href="#screenshot">#</a></h3>
<p>After you setup all, you should have some dashboard like this.</p>
<p><img loading="lazy" src="/images/2017/07/Grafana_LizardFS_Metrics.jpg" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kruyt.org/tags/grafana/">grafana</a></li>
      <li><a href="https://kruyt.org/tags/telegraf/">telegraf</a></li>
      <li><a href="https://kruyt.org/tags/influxdb/">influxdb</a></li>
      <li><a href="https://kruyt.org/tags/lizardfs/">lizardfs</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="https://kruyt.org/">Dennis Kruyt</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
