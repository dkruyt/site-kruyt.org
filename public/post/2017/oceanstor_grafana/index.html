<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Huawei OceanStor metrics in Grafana | Dennis Kruyt</title>
<meta name="keywords" content="huawei, grafana, metrics, influxdb, telegraf, snmp" />
<meta name="description" content="I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn&rsquo;t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.
Pre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first.">
<meta name="author" content="Dennis Kruyt">
<link rel="canonical" href="https://kruyt.org/post/2017/oceanstor_grafana/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://kruyt.org/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://kruyt.org/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://kruyt.org/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://kruyt.org/apple-touch-icon.png">
<link rel="mask-icon" href="https://kruyt.org/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.89.4" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Huawei OceanStor metrics in Grafana" />
<meta property="og:description" content="I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn&rsquo;t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.
Pre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kruyt.org/post/2017/oceanstor_grafana/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-07-22T19:27:02&#43;00:00" />
<meta property="article:modified_time" content="2017-07-22T19:27:02&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Huawei OceanStor metrics in Grafana"/>
<meta name="twitter:description" content="I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn&rsquo;t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.
Pre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://kruyt.org/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Huawei OceanStor metrics in Grafana",
      "item": "https://kruyt.org/post/2017/oceanstor_grafana/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Huawei OceanStor metrics in Grafana",
  "name": "Huawei OceanStor metrics in Grafana",
  "description": "I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn\u0026rsquo;t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.\nPre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first.",
  "keywords": [
    "huawei", "grafana", "metrics", "influxdb", "telegraf", "snmp"
  ],
  "articleBody": "I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn’t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.\nPre install Make sure you have installed InfluxDB as the time-series database Telegraf as the collector first.\nQuick Start Get the all files, at My GitHub page.\n Enable SNMP on your Huawei OceanStor storage. Put hw_stor.conf in your /etc/telegraf/telegraf.d directory. Edit the community string as appropriate. Edit the SNMP version as appropriate, please note that verion 2 is disabled by default on the Dorado storage, check with show snmp version on the Storage. Edit the ‘agents’ list to include all of your monitored OceanStor storages. Put the files in the mibs dir on the server running telgraf. With Ubuntu it is in /usr/share/snmp/mibs other Linux distributions can differ. Import the Grafana dashboard in Grafana.  Screenshot After you setup all, you should have some dashboard like this.\n Note, on the latest version on GitHub CIFS and NFS stats has been added, not on this screenshot yet.\n ",
  "wordCount" : "211",
  "inLanguage": "en",
  "datePublished": "2017-07-22T19:27:02Z",
  "dateModified": "2017-07-22T19:27:02Z",
  "author":{
    "@type": "Person",
    "name": "Dennis Kruyt"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://kruyt.org/post/2017/oceanstor_grafana/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Dennis Kruyt",
    "logo": {
      "@type": "ImageObject",
      "url": "https://kruyt.org/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://kruyt.org/" accesskey="h" title="Dennis Kruyt (Alt + H)">Dennis Kruyt</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Huawei OceanStor metrics in Grafana
    </h1>
    <div class="post-meta"><span title='2017-07-22 19:27:02 +0000 UTC'>July 22, 2017</span>&nbsp;·&nbsp;Dennis Kruyt

</div>
  </header> 
  <div class="post-content"><p>I manage a couple of storages at work. I got a few Huawei OceanStor storages. v2 as wel v3 storages. There is some commercial tooling from Huawei available to gather metrics, but that didn&rsquo;t fit my needs. I found out that all or almost all metrics that I need are available via SNMP. So it was not hard to setup a Grafana dashboard with all metrics.</p>
<h3 id="pre-install">Pre install<a hidden class="anchor" aria-hidden="true" href="#pre-install">#</a></h3>
<p>Make sure you have installed <a href="https://portal.influxdata.com/downloads">InfluxDB</a> as the time-series database <a href="https://portal.influxdata.com/downloads">Telegraf</a> as the collector first.</p>
<h3 id="quick-start">Quick Start<a hidden class="anchor" aria-hidden="true" href="#quick-start">#</a></h3>
<p>Get the all files, at <a href="https://github.com/dkruyt/OceanStor_Grafana">My GitHub page</a>.</p>
<ul>
<li>Enable SNMP on your Huawei OceanStor storage.</li>
<li>Put hw_stor.conf in your <code>/etc/telegraf/telegraf.d</code> directory.</li>
<li>Edit the community string as appropriate.</li>
<li>Edit the SNMP version as appropriate, please note that verion 2 is disabled by default on the Dorado storage, check with <code>show snmp version</code> on the Storage.</li>
<li>Edit the &lsquo;agents&rsquo; list to include all of your monitored OceanStor storages.</li>
<li>Put the files in the mibs dir on the server running telgraf. With Ubuntu it is in <code>/usr/share/snmp/mibs</code> other Linux distributions can differ.</li>
<li>Import the Grafana dashboard in Grafana.</li>
</ul>
<h3 id="screenshot">Screenshot<a hidden class="anchor" aria-hidden="true" href="#screenshot">#</a></h3>
<p>After you setup all, you should have some dashboard like this.</p>
<blockquote>
<p>Note, on the latest version on GitHub CIFS and NFS stats has been added, not on this screenshot yet.</p>
</blockquote>
<p><img loading="lazy" src="https://github.com/dkruyt/OceanStor_Grafana/raw/master/Grafana___Huawei_Storage_edit.jpg" alt="Grafana screenshot zswap"  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://kruyt.org/tags/huawei/">huawei</a></li>
      <li><a href="https://kruyt.org/tags/grafana/">grafana</a></li>
      <li><a href="https://kruyt.org/tags/metrics/">metrics</a></li>
      <li><a href="https://kruyt.org/tags/influxdb/">influxdb</a></li>
      <li><a href="https://kruyt.org/tags/telegraf/">telegraf</a></li>
      <li><a href="https://kruyt.org/tags/snmp/">snmp</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2021 <a href="https://kruyt.org/">Dennis Kruyt</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
